f4385faa2572e9249477cc61c999cb26
const fs = require('fs-extra');
const path = require('path');

/**
 * Resolves internal OneNote links to Obsidian wikilinks
 * @param {Object} pageIdMap - Map of page IDs to their metadata
 * @param {string} outputBase - Base output directory (notebook root)
 * @returns {Promise<void>}
 */
async function resolveInternalLinks(pageIdMap, outputBase) {
  for (const [pageId, info] of Object.entries(pageIdMap)) {
    if (info.isDir) continue;
    let content = await fs.readFile(info.path, 'utf8');
    let modified = false;
    for (const link of info.internalLinks || []) {
      // Try to find the target item (page, section, or group) in our map
      let targetId = Object.keys(pageIdMap).find(id => {
        // Ignore empty or invalid IDs
        if (!id || id === 'undefined' || id === 'null') return false;

        // 1. Standard relaxed match (handles encoded IDs)
        if (link.href.includes(id) || link.href.includes(encodeURIComponent(id))) {
          return true;
        }

        // 2. Fuzzy match: OneNote IDs in DOM often look like "{UUID}{1}", 
        // while links might use "UUID" or "section-id={UUID}".
        // We strip braces and suffixes to get the core UUID.
        // Example: "{123-456}{1}" -> "123-456"
        const cleanId = id.replace(/^\{/, '').split('}')[0];

        // Only perform fuzzy string match if we have a valid-looking UUID (min length)
        if (cleanId.length > 20 && link.href.includes(cleanId)) {
          return true;
        }
        return false;
      });

      // 3. Fallback: Path-based matching for onenote: links (User suggestion)
      // Example page: onenote:Group\Section.one#Page&...
      // Example section: onenote:Section.one#section-id={...}&end
      if (!targetId && link.href.includes('onenote:')) {
        const parts = link.href.split('#');
        if (parts.length > 1) {
          try {
            const hierarchy = decodeURIComponent(parts[0].replace('onenote:', '').replace(/\\/g, '/')).replace(/\.one$/, '');
            const fragment = decodeURIComponent(parts[1]);
            let fullTargetPath;
            if (fragment.startsWith('section-id=')) {
              // Link to a section/folder
              fullTargetPath = hierarchy.toLowerCase();
            } else {
              // Link to a page
              const pageName = fragment.split('&')[0];
              fullTargetPath = hierarchy ? `${hierarchy}/${pageName}`.toLowerCase() : pageName.toLowerCase();
            }
            targetId = Object.keys(pageIdMap).find(id => {
              const info = pageIdMap[id];
              const relToVault = path.relative(outputBase, info.path).replace(/\.md$/, '').toLowerCase();
              // Match either the full path or just the end (if sections are deeply nested)
              return relToVault === fullTargetPath || relToVault.endsWith('/' + fullTargetPath);
            });
          } catch (e) {
            // Ignore parsing errors
          }
        }
      }
      if (targetId && targetId !== pageId) {
        const targetInfo = pageIdMap[targetId];

        // Use path relative to the Output Base (Notebook Root)
        // This creates "Absolute in Vault" style links: [[Group/Section/Page]]
        let relPath = path.relative(outputBase, targetInfo.path);

        // Avoid .md extension for Wikilinks to files
        const cleanPath = targetInfo.isDir ? relPath : relPath.replace(/\.md$/, '');

        // IMPORTANT: Use a non-capturing group for the bracketed text because 
        // Turndown might have escaped characters (like _ to \_) inside it.
        // We target the unique onenote-link ID instead.
        const placeholderRegex = new RegExp(`\\[\\[.*?\\]\\]<!-- onenote-link:${link.id} -->`, 'g');
        content = content.replace(placeholderRegex, `[[${cleanPath}|${link.text}]]`);
        modified = true;
      }
    }

    // Cleanup: Remove any remaining onenote-link comments (for links that weren't resolved)
    // Also remove the comments for successfully resolved links if the regex above didn't catch them all (it should have replaced the whole block)
    // But specifically for UNRESOLVED links, we want to keep the text but remove the comment.
    // The structure for unresolved is likely: [[Link Text]]<!-- onenote-link:id -->
    // We just want to remove the comment part globally.
    if (content.includes('<!-- onenote-link:')) {
      content = content.replace(/<!-- onenote-link:.*? -->/g, '');
      modified = true;
    }
    if (modified) {
      await fs.writeFile(info.path, content);
    }
  }
}
module.exports = {
  resolveInternalLinks
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwicmVzb2x2ZUludGVybmFsTGlua3MiLCJwYWdlSWRNYXAiLCJvdXRwdXRCYXNlIiwicGFnZUlkIiwiaW5mbyIsIk9iamVjdCIsImVudHJpZXMiLCJpc0RpciIsImNvbnRlbnQiLCJyZWFkRmlsZSIsIm1vZGlmaWVkIiwibGluayIsImludGVybmFsTGlua3MiLCJ0YXJnZXRJZCIsImtleXMiLCJmaW5kIiwiaWQiLCJocmVmIiwiaW5jbHVkZXMiLCJlbmNvZGVVUklDb21wb25lbnQiLCJjbGVhbklkIiwicmVwbGFjZSIsInNwbGl0IiwibGVuZ3RoIiwicGFydHMiLCJoaWVyYXJjaHkiLCJkZWNvZGVVUklDb21wb25lbnQiLCJmcmFnbWVudCIsImZ1bGxUYXJnZXRQYXRoIiwic3RhcnRzV2l0aCIsInRvTG93ZXJDYXNlIiwicGFnZU5hbWUiLCJyZWxUb1ZhdWx0IiwicmVsYXRpdmUiLCJlbmRzV2l0aCIsImUiLCJ0YXJnZXRJbmZvIiwicmVsUGF0aCIsImNsZWFuUGF0aCIsInBsYWNlaG9sZGVyUmVnZXgiLCJSZWdFeHAiLCJ0ZXh0Iiwid3JpdGVGaWxlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImxpbmtSZXNvbHZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzLWV4dHJhJyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuXG4vKipcbiAqIFJlc29sdmVzIGludGVybmFsIE9uZU5vdGUgbGlua3MgdG8gT2JzaWRpYW4gd2lraWxpbmtzXG4gKiBAcGFyYW0ge09iamVjdH0gcGFnZUlkTWFwIC0gTWFwIG9mIHBhZ2UgSURzIHRvIHRoZWlyIG1ldGFkYXRhXG4gKiBAcGFyYW0ge3N0cmluZ30gb3V0cHV0QmFzZSAtIEJhc2Ugb3V0cHV0IGRpcmVjdG9yeSAobm90ZWJvb2sgcm9vdClcbiAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICovXG5hc3luYyBmdW5jdGlvbiByZXNvbHZlSW50ZXJuYWxMaW5rcyhwYWdlSWRNYXAsIG91dHB1dEJhc2UpIHtcbiAgICBmb3IgKGNvbnN0IFtwYWdlSWQsIGluZm9dIG9mIE9iamVjdC5lbnRyaWVzKHBhZ2VJZE1hcCkpIHtcbiAgICAgICAgaWYgKGluZm8uaXNEaXIpIGNvbnRpbnVlO1xuXG4gICAgICAgIGxldCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoaW5mby5wYXRoLCAndXRmOCcpO1xuICAgICAgICBsZXQgbW9kaWZpZWQgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKGNvbnN0IGxpbmsgb2YgaW5mby5pbnRlcm5hbExpbmtzIHx8IFtdKSB7XG4gICAgICAgICAgICAvLyBUcnkgdG8gZmluZCB0aGUgdGFyZ2V0IGl0ZW0gKHBhZ2UsIHNlY3Rpb24sIG9yIGdyb3VwKSBpbiBvdXIgbWFwXG4gICAgICAgICAgICBsZXQgdGFyZ2V0SWQgPSBPYmplY3Qua2V5cyhwYWdlSWRNYXApLmZpbmQoaWQgPT4ge1xuICAgICAgICAgICAgICAgIC8vIElnbm9yZSBlbXB0eSBvciBpbnZhbGlkIElEc1xuICAgICAgICAgICAgICAgIGlmICghaWQgfHwgaWQgPT09ICd1bmRlZmluZWQnIHx8IGlkID09PSAnbnVsbCcpIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vIDEuIFN0YW5kYXJkIHJlbGF4ZWQgbWF0Y2ggKGhhbmRsZXMgZW5jb2RlZCBJRHMpXG4gICAgICAgICAgICAgICAgaWYgKGxpbmsuaHJlZi5pbmNsdWRlcyhpZCkgfHwgbGluay5ocmVmLmluY2x1ZGVzKGVuY29kZVVSSUNvbXBvbmVudChpZCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIDIuIEZ1enp5IG1hdGNoOiBPbmVOb3RlIElEcyBpbiBET00gb2Z0ZW4gbG9vayBsaWtlIFwie1VVSUR9ezF9XCIsIFxuICAgICAgICAgICAgICAgIC8vIHdoaWxlIGxpbmtzIG1pZ2h0IHVzZSBcIlVVSURcIiBvciBcInNlY3Rpb24taWQ9e1VVSUR9XCIuXG4gICAgICAgICAgICAgICAgLy8gV2Ugc3RyaXAgYnJhY2VzIGFuZCBzdWZmaXhlcyB0byBnZXQgdGhlIGNvcmUgVVVJRC5cbiAgICAgICAgICAgICAgICAvLyBFeGFtcGxlOiBcInsxMjMtNDU2fXsxfVwiIC0+IFwiMTIzLTQ1NlwiXG4gICAgICAgICAgICAgICAgY29uc3QgY2xlYW5JZCA9IGlkLnJlcGxhY2UoL15cXHsvLCAnJykuc3BsaXQoJ30nKVswXTtcblxuICAgICAgICAgICAgICAgIC8vIE9ubHkgcGVyZm9ybSBmdXp6eSBzdHJpbmcgbWF0Y2ggaWYgd2UgaGF2ZSBhIHZhbGlkLWxvb2tpbmcgVVVJRCAobWluIGxlbmd0aClcbiAgICAgICAgICAgICAgICBpZiAoY2xlYW5JZC5sZW5ndGggPiAyMCAmJiBsaW5rLmhyZWYuaW5jbHVkZXMoY2xlYW5JZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIDMuIEZhbGxiYWNrOiBQYXRoLWJhc2VkIG1hdGNoaW5nIGZvciBvbmVub3RlOiBsaW5rcyAoVXNlciBzdWdnZXN0aW9uKVxuICAgICAgICAgICAgLy8gRXhhbXBsZSBwYWdlOiBvbmVub3RlOkdyb3VwXFxTZWN0aW9uLm9uZSNQYWdlJi4uLlxuICAgICAgICAgICAgLy8gRXhhbXBsZSBzZWN0aW9uOiBvbmVub3RlOlNlY3Rpb24ub25lI3NlY3Rpb24taWQ9ey4uLn0mZW5kXG4gICAgICAgICAgICBpZiAoIXRhcmdldElkICYmIGxpbmsuaHJlZi5pbmNsdWRlcygnb25lbm90ZTonKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gbGluay5ocmVmLnNwbGl0KCcjJyk7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhpZXJhcmNoeSA9IGRlY29kZVVSSUNvbXBvbmVudChwYXJ0c1swXS5yZXBsYWNlKCdvbmVub3RlOicsICcnKS5yZXBsYWNlKC9cXFxcL2csICcvJykpLnJlcGxhY2UoL1xcLm9uZSQvLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmcmFnbWVudCA9IGRlY29kZVVSSUNvbXBvbmVudChwYXJ0c1sxXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmdWxsVGFyZ2V0UGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmcmFnbWVudC5zdGFydHNXaXRoKCdzZWN0aW9uLWlkPScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGluayB0byBhIHNlY3Rpb24vZm9sZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFRhcmdldFBhdGggPSBoaWVyYXJjaHkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGluayB0byBhIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYWdlTmFtZSA9IGZyYWdtZW50LnNwbGl0KCcmJylbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFRhcmdldFBhdGggPSBoaWVyYXJjaHkgPyBgJHtoaWVyYXJjaHl9LyR7cGFnZU5hbWV9YC50b0xvd2VyQ2FzZSgpIDogcGFnZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQgPSBPYmplY3Qua2V5cyhwYWdlSWRNYXApLmZpbmQoaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZm8gPSBwYWdlSWRNYXBbaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlbFRvVmF1bHQgPSBwYXRoLnJlbGF0aXZlKG91dHB1dEJhc2UsIGluZm8ucGF0aCkucmVwbGFjZSgvXFwubWQkLywgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWF0Y2ggZWl0aGVyIHRoZSBmdWxsIHBhdGggb3IganVzdCB0aGUgZW5kIChpZiBzZWN0aW9ucyBhcmUgZGVlcGx5IG5lc3RlZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVsVG9WYXVsdCA9PT0gZnVsbFRhcmdldFBhdGggfHwgcmVsVG9WYXVsdC5lbmRzV2l0aCgnLycgKyBmdWxsVGFyZ2V0UGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIHBhcnNpbmcgZXJyb3JzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICBpZiAodGFyZ2V0SWQgJiYgdGFyZ2V0SWQgIT09IHBhZ2VJZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEluZm8gPSBwYWdlSWRNYXBbdGFyZ2V0SWRdO1xuXG4gICAgICAgICAgICAgICAgLy8gVXNlIHBhdGggcmVsYXRpdmUgdG8gdGhlIE91dHB1dCBCYXNlIChOb3RlYm9vayBSb290KVxuICAgICAgICAgICAgICAgIC8vIFRoaXMgY3JlYXRlcyBcIkFic29sdXRlIGluIFZhdWx0XCIgc3R5bGUgbGlua3M6IFtbR3JvdXAvU2VjdGlvbi9QYWdlXV1cbiAgICAgICAgICAgICAgICBsZXQgcmVsUGF0aCA9IHBhdGgucmVsYXRpdmUob3V0cHV0QmFzZSwgdGFyZ2V0SW5mby5wYXRoKTtcblxuICAgICAgICAgICAgICAgIC8vIEF2b2lkIC5tZCBleHRlbnNpb24gZm9yIFdpa2lsaW5rcyB0byBmaWxlc1xuICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuUGF0aCA9IHRhcmdldEluZm8uaXNEaXIgPyByZWxQYXRoIDogcmVsUGF0aC5yZXBsYWNlKC9cXC5tZCQvLCAnJyk7XG5cbiAgICAgICAgICAgICAgICAvLyBJTVBPUlRBTlQ6IFVzZSBhIG5vbi1jYXB0dXJpbmcgZ3JvdXAgZm9yIHRoZSBicmFja2V0ZWQgdGV4dCBiZWNhdXNlIFxuICAgICAgICAgICAgICAgIC8vIFR1cm5kb3duIG1pZ2h0IGhhdmUgZXNjYXBlZCBjaGFyYWN0ZXJzIChsaWtlIF8gdG8gXFxfKSBpbnNpZGUgaXQuXG4gICAgICAgICAgICAgICAgLy8gV2UgdGFyZ2V0IHRoZSB1bmlxdWUgb25lbm90ZS1saW5rIElEIGluc3RlYWQuXG4gICAgICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJSZWdleCA9IG5ldyBSZWdFeHAoYFxcXFxbXFxcXFsuKj9cXFxcXVxcXFxdPCEtLSBvbmVub3RlLWxpbms6JHtsaW5rLmlkfSAtLT5gLCAnZycpO1xuXG4gICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShwbGFjZWhvbGRlclJlZ2V4LCBgW1ske2NsZWFuUGF0aH18JHtsaW5rLnRleHR9XV1gKTtcbiAgICAgICAgICAgICAgICBtb2RpZmllZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDbGVhbnVwOiBSZW1vdmUgYW55IHJlbWFpbmluZyBvbmVub3RlLWxpbmsgY29tbWVudHMgKGZvciBsaW5rcyB0aGF0IHdlcmVuJ3QgcmVzb2x2ZWQpXG4gICAgICAgIC8vIEFsc28gcmVtb3ZlIHRoZSBjb21tZW50cyBmb3Igc3VjY2Vzc2Z1bGx5IHJlc29sdmVkIGxpbmtzIGlmIHRoZSByZWdleCBhYm92ZSBkaWRuJ3QgY2F0Y2ggdGhlbSBhbGwgKGl0IHNob3VsZCBoYXZlIHJlcGxhY2VkIHRoZSB3aG9sZSBibG9jaylcbiAgICAgICAgLy8gQnV0IHNwZWNpZmljYWxseSBmb3IgVU5SRVNPTFZFRCBsaW5rcywgd2Ugd2FudCB0byBrZWVwIHRoZSB0ZXh0IGJ1dCByZW1vdmUgdGhlIGNvbW1lbnQuXG4gICAgICAgIC8vIFRoZSBzdHJ1Y3R1cmUgZm9yIHVucmVzb2x2ZWQgaXMgbGlrZWx5OiBbW0xpbmsgVGV4dF1dPCEtLSBvbmVub3RlLWxpbms6aWQgLS0+XG4gICAgICAgIC8vIFdlIGp1c3Qgd2FudCB0byByZW1vdmUgdGhlIGNvbW1lbnQgcGFydCBnbG9iYWxseS5cbiAgICAgICAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJzwhLS0gb25lbm90ZS1saW5rOicpKSB7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC88IS0tIG9uZW5vdGUtbGluazouKj8gLS0+L2csICcnKTtcbiAgICAgICAgICAgIG1vZGlmaWVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtb2RpZmllZCkge1xuICAgICAgICAgICAgYXdhaXQgZnMud3JpdGVGaWxlKGluZm8ucGF0aCwgY29udGVudCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0geyByZXNvbHZlSW50ZXJuYWxMaW5rcyB9O1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxFQUFFLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDOUIsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsTUFBTSxDQUFDOztBQUU1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlRSxvQkFBb0JBLENBQUNDLFNBQVMsRUFBRUMsVUFBVSxFQUFFO0VBQ3ZELEtBQUssTUFBTSxDQUFDQyxNQUFNLEVBQUVDLElBQUksQ0FBQyxJQUFJQyxNQUFNLENBQUNDLE9BQU8sQ0FBQ0wsU0FBUyxDQUFDLEVBQUU7SUFDcEQsSUFBSUcsSUFBSSxDQUFDRyxLQUFLLEVBQUU7SUFFaEIsSUFBSUMsT0FBTyxHQUFHLE1BQU1YLEVBQUUsQ0FBQ1ksUUFBUSxDQUFDTCxJQUFJLENBQUNMLElBQUksRUFBRSxNQUFNLENBQUM7SUFDbEQsSUFBSVcsUUFBUSxHQUFHLEtBQUs7SUFFcEIsS0FBSyxNQUFNQyxJQUFJLElBQUlQLElBQUksQ0FBQ1EsYUFBYSxJQUFJLEVBQUUsRUFBRTtNQUN6QztNQUNBLElBQUlDLFFBQVEsR0FBR1IsTUFBTSxDQUFDUyxJQUFJLENBQUNiLFNBQVMsQ0FBQyxDQUFDYyxJQUFJLENBQUNDLEVBQUUsSUFBSTtRQUM3QztRQUNBLElBQUksQ0FBQ0EsRUFBRSxJQUFJQSxFQUFFLEtBQUssV0FBVyxJQUFJQSxFQUFFLEtBQUssTUFBTSxFQUFFLE9BQU8sS0FBSzs7UUFFNUQ7UUFDQSxJQUFJTCxJQUFJLENBQUNNLElBQUksQ0FBQ0MsUUFBUSxDQUFDRixFQUFFLENBQUMsSUFBSUwsSUFBSSxDQUFDTSxJQUFJLENBQUNDLFFBQVEsQ0FBQ0Msa0JBQWtCLENBQUNILEVBQUUsQ0FBQyxDQUFDLEVBQUU7VUFDdEUsT0FBTyxJQUFJO1FBQ2Y7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQSxNQUFNSSxPQUFPLEdBQUdKLEVBQUUsQ0FBQ0ssT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQ0MsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQzs7UUFFbkQ7UUFDQSxJQUFJRixPQUFPLENBQUNHLE1BQU0sR0FBRyxFQUFFLElBQUlaLElBQUksQ0FBQ00sSUFBSSxDQUFDQyxRQUFRLENBQUNFLE9BQU8sQ0FBQyxFQUFFO1VBQ3BELE9BQU8sSUFBSTtRQUNmO1FBRUEsT0FBTyxLQUFLO01BQ2hCLENBQUMsQ0FBQzs7TUFFRjtNQUNBO01BQ0E7TUFDQSxJQUFJLENBQUNQLFFBQVEsSUFBSUYsSUFBSSxDQUFDTSxJQUFJLENBQUNDLFFBQVEsQ0FBQyxVQUFVLENBQUMsRUFBRTtRQUM3QyxNQUFNTSxLQUFLLEdBQUdiLElBQUksQ0FBQ00sSUFBSSxDQUFDSyxLQUFLLENBQUMsR0FBRyxDQUFDO1FBQ2xDLElBQUlFLEtBQUssQ0FBQ0QsTUFBTSxHQUFHLENBQUMsRUFBRTtVQUNsQixJQUFJO1lBQ0EsTUFBTUUsU0FBUyxHQUFHQyxrQkFBa0IsQ0FBQ0YsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDSCxPQUFPLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxDQUFDQSxPQUFPLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUNBLE9BQU8sQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDO1lBQ2hILE1BQU1NLFFBQVEsR0FBR0Qsa0JBQWtCLENBQUNGLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUU3QyxJQUFJSSxjQUFjO1lBQ2xCLElBQUlELFFBQVEsQ0FBQ0UsVUFBVSxDQUFDLGFBQWEsQ0FBQyxFQUFFO2NBQ3BDO2NBQ0FELGNBQWMsR0FBR0gsU0FBUyxDQUFDSyxXQUFXLENBQUMsQ0FBQztZQUM1QyxDQUFDLE1BQU07Y0FDSDtjQUNBLE1BQU1DLFFBQVEsR0FBR0osUUFBUSxDQUFDTCxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2NBQ3ZDTSxjQUFjLEdBQUdILFNBQVMsR0FBRyxHQUFHQSxTQUFTLElBQUlNLFFBQVEsRUFBRSxDQUFDRCxXQUFXLENBQUMsQ0FBQyxHQUFHQyxRQUFRLENBQUNELFdBQVcsQ0FBQyxDQUFDO1lBQ2xHO1lBRUFqQixRQUFRLEdBQUdSLE1BQU0sQ0FBQ1MsSUFBSSxDQUFDYixTQUFTLENBQUMsQ0FBQ2MsSUFBSSxDQUFDQyxFQUFFLElBQUk7Y0FDekMsTUFBTVosSUFBSSxHQUFHSCxTQUFTLENBQUNlLEVBQUUsQ0FBQztjQUMxQixNQUFNZ0IsVUFBVSxHQUFHakMsSUFBSSxDQUFDa0MsUUFBUSxDQUFDL0IsVUFBVSxFQUFFRSxJQUFJLENBQUNMLElBQUksQ0FBQyxDQUFDc0IsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQ1MsV0FBVyxDQUFDLENBQUM7Y0FDMUY7Y0FDQSxPQUFPRSxVQUFVLEtBQUtKLGNBQWMsSUFBSUksVUFBVSxDQUFDRSxRQUFRLENBQUMsR0FBRyxHQUFHTixjQUFjLENBQUM7WUFDckYsQ0FBQyxDQUFDO1VBQ04sQ0FBQyxDQUFDLE9BQU9PLENBQUMsRUFBRTtZQUNSO1VBQUE7UUFFUjtNQUNKO01BSUEsSUFBSXRCLFFBQVEsSUFBSUEsUUFBUSxLQUFLVixNQUFNLEVBQUU7UUFDakMsTUFBTWlDLFVBQVUsR0FBR25DLFNBQVMsQ0FBQ1ksUUFBUSxDQUFDOztRQUV0QztRQUNBO1FBQ0EsSUFBSXdCLE9BQU8sR0FBR3RDLElBQUksQ0FBQ2tDLFFBQVEsQ0FBQy9CLFVBQVUsRUFBRWtDLFVBQVUsQ0FBQ3JDLElBQUksQ0FBQzs7UUFFeEQ7UUFDQSxNQUFNdUMsU0FBUyxHQUFHRixVQUFVLENBQUM3QixLQUFLLEdBQUc4QixPQUFPLEdBQUdBLE9BQU8sQ0FBQ2hCLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDOztRQUUzRTtRQUNBO1FBQ0E7UUFDQSxNQUFNa0IsZ0JBQWdCLEdBQUcsSUFBSUMsTUFBTSxDQUFDLG9DQUFvQzdCLElBQUksQ0FBQ0ssRUFBRSxNQUFNLEVBQUUsR0FBRyxDQUFDO1FBRTNGUixPQUFPLEdBQUdBLE9BQU8sQ0FBQ2EsT0FBTyxDQUFDa0IsZ0JBQWdCLEVBQUUsS0FBS0QsU0FBUyxJQUFJM0IsSUFBSSxDQUFDOEIsSUFBSSxJQUFJLENBQUM7UUFDNUUvQixRQUFRLEdBQUcsSUFBSTtNQUNuQjtJQUNKOztJQUVBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQSxJQUFJRixPQUFPLENBQUNVLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFO01BQ3hDVixPQUFPLEdBQUdBLE9BQU8sQ0FBQ2EsT0FBTyxDQUFDLDRCQUE0QixFQUFFLEVBQUUsQ0FBQztNQUMzRFgsUUFBUSxHQUFHLElBQUk7SUFDbkI7SUFFQSxJQUFJQSxRQUFRLEVBQUU7TUFDVixNQUFNYixFQUFFLENBQUM2QyxTQUFTLENBQUN0QyxJQUFJLENBQUNMLElBQUksRUFBRVMsT0FBTyxDQUFDO0lBQzFDO0VBQ0o7QUFDSjtBQUVBbUMsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFBRTVDO0FBQXFCLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=