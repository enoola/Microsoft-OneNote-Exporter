6799ed006183132aceded920b306128d
const TurndownService = require('turndown');
const {
  gfm
} = require('turndown-plugin-gfm');

/**
 * Creates a configured TurndownService instance with OneNote-specific rules
 * @returns {TurndownService} Configured Turndown instance
 */
function createMarkdownConverter() {
  const td = new TurndownService({
    headingStyle: 'atx',
    codeBlockStyle: 'fenced'
  });
  td.use(gfm);

  // Rule to handle images with our custom data-local-src attribute (Obsidian style)
  td.addRule('localImages', {
    filter: node => node.nodeName === 'IMG' && node.getAttribute('data-local-src'),
    replacement: (content, node) => {
      const localId = node.getAttribute('data-local-src');
      return `![[assets/${localId}.png]]`;
    }
  });

  // Rule for local file attachments (Obsidian style)
  td.addRule('localFiles', {
    filter: node => node.nodeName === 'A' && node.getAttribute('data-local-file'),
    replacement: (content, node) => {
      const localName = node.getAttribute('data-local-file');
      // Prefer the explicitly passed filename from scraper, falling back to text
      const originalName = node.getAttribute('data-filename') || node.innerText.trim() || 'file';
      const ext = originalName.includes('.') ? originalName.split('.').pop() : 'bin';
      return `[[assets/${localName}.${ext}]]`;
    }
  });

  // Rule for internal cross-links
  td.addRule('internalLinks', {
    filter: node => node.nodeName === 'A' && node.getAttribute('data-internal-link'),
    replacement: (content, node) => {
      const linkId = node.getAttribute('data-internal-link');
      const text = node.innerText.trim();
      // Use a specific marker for post-processing
      return `[[${text}]]<!-- onenote-link:${linkId} -->`;
    }
  });

  // Rule for YouTube/Vimeo embeds
  td.addRule('embeds', {
    filter: node => node.nodeName === 'IFRAME' && node.getAttribute('data-embed-id'),
    replacement: (content, node) => {
      const src = node.getAttribute('src');
      // Convert embed URLs back to watch URLs if possible
      let url = src;
      if (src.includes('youtube.com/embed/')) {
        url = src.replace('youtube.com/embed/', 'youtube.com/watch?v=');
      } else if (src.includes('player.vimeo.com/video/')) {
        url = src.replace('player.vimeo.com/video/', 'vimeo.com/');
      }
      return `\n\n[Video Link](${url})\n\n`;
    }
  });

  // Rule for local videos with data-local-video (Obsidian style)
  td.addRule('localVideos', {
    filter: node => node.nodeName === 'VIDEO' && node.getAttribute('data-local-video'),
    replacement: (content, node) => {
      const localId = node.getAttribute('data-local-video');
      return `\n\n![[assets/${localId}.mp4]]\n\n`;
    }
  });

  // Rule for Strikethrough (OneNote specific)
  td.addRule('strikethrough', {
    filter: node => {
      const classes = typeof node.className === 'string' ? node.className : '';
      const style = node.getAttribute('style') || '';
      return classes.includes('Strikethrough') || style.includes('text-decoration: line-through');
    },
    replacement: content => `~~${content}~~`
  });

  // Rule to ignore OneNote table junk (resize handles, hover UI, etc.)
  td.addRule('ignoreTableJunk', {
    filter: node => {
      const classes = node.className || '';
      // REMOVED 'RelativeElementContainer' as it often wraps images we want to keep
      // REMOVED 'role="presentation"' as it is used for image containers
      return classes.includes('TableHover') || classes.includes('TableInsertRowGap') || classes.includes('TableColumnHandle') || classes.includes('TableColumnWidthSpacer') || classes.includes('TableColumnResizeHandle');
    },
    replacement: () => ''
  });

  // Rule for OutlineContainer to ensure block separation
  td.addRule('outlines', {
    filter: node => typeof node.className === 'string' && node.className.includes('OutlineContainer'),
    replacement: content => `\n\n${content}\n\n`
  });

  // Ensure table cells are treated as such even with weird roles
  td.addRule('tableCells', {
    filter: node => node.nodeName === 'TD' || node.nodeName === 'TH' || node.getAttribute('role') === 'rowheader' || node.getAttribute('role') === 'columnheader',
    replacement: function (content, node) {
      // Trim and ensure no newlines inside cells for GFM compat
      return '| ' + content.trim().replace(/\n/g, ' ') + ' ';
    }
  });

  // We need a custom table row rule because OneNote doesn't always use standard table structures
  td.addRule('tableRow', {
    filter: 'tr',
    replacement: function (content, node) {
      let result = content + '|\n';
      // If it's the first row, add the GFM separator
      const isFirstRow = node === node.parentElement.firstElementChild;
      if (isFirstRow) {
        const cells = node.querySelectorAll('td, th, [role*="header"]');
        result += '|' + Array.from(cells).map(() => ' --- ').join('|') + '|\n';
      }
      return result;
    }
  });

  // Custom table rule to just wrap the content
  td.addRule('table', {
    filter: 'table',
    replacement: function (content) {
      return '\n\n' + content + '\n\n';
    }
  });
  return td;
}
module.exports = {
  createMarkdownConverter
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUdXJuZG93blNlcnZpY2UiLCJyZXF1aXJlIiwiZ2ZtIiwiY3JlYXRlTWFya2Rvd25Db252ZXJ0ZXIiLCJ0ZCIsImhlYWRpbmdTdHlsZSIsImNvZGVCbG9ja1N0eWxlIiwidXNlIiwiYWRkUnVsZSIsImZpbHRlciIsIm5vZGUiLCJub2RlTmFtZSIsImdldEF0dHJpYnV0ZSIsInJlcGxhY2VtZW50IiwiY29udGVudCIsImxvY2FsSWQiLCJsb2NhbE5hbWUiLCJvcmlnaW5hbE5hbWUiLCJpbm5lclRleHQiLCJ0cmltIiwiZXh0IiwiaW5jbHVkZXMiLCJzcGxpdCIsInBvcCIsImxpbmtJZCIsInRleHQiLCJzcmMiLCJ1cmwiLCJyZXBsYWNlIiwiY2xhc3NlcyIsImNsYXNzTmFtZSIsInN0eWxlIiwicmVzdWx0IiwiaXNGaXJzdFJvdyIsInBhcmVudEVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNlbGxzIiwicXVlcnlTZWxlY3RvckFsbCIsIkFycmF5IiwiZnJvbSIsIm1hcCIsImpvaW4iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsicGFyc2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFR1cm5kb3duU2VydmljZSA9IHJlcXVpcmUoJ3R1cm5kb3duJyk7XG5jb25zdCB7IGdmbSB9ID0gcmVxdWlyZSgndHVybmRvd24tcGx1Z2luLWdmbScpO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBjb25maWd1cmVkIFR1cm5kb3duU2VydmljZSBpbnN0YW5jZSB3aXRoIE9uZU5vdGUtc3BlY2lmaWMgcnVsZXNcbiAqIEByZXR1cm5zIHtUdXJuZG93blNlcnZpY2V9IENvbmZpZ3VyZWQgVHVybmRvd24gaW5zdGFuY2VcbiAqL1xuZnVuY3Rpb24gY3JlYXRlTWFya2Rvd25Db252ZXJ0ZXIoKSB7XG4gICAgY29uc3QgdGQgPSBuZXcgVHVybmRvd25TZXJ2aWNlKHtcbiAgICAgICAgaGVhZGluZ1N0eWxlOiAnYXR4JyxcbiAgICAgICAgY29kZUJsb2NrU3R5bGU6ICdmZW5jZWQnXG4gICAgfSk7XG4gICAgdGQudXNlKGdmbSk7XG5cbiAgICAvLyBSdWxlIHRvIGhhbmRsZSBpbWFnZXMgd2l0aCBvdXIgY3VzdG9tIGRhdGEtbG9jYWwtc3JjIGF0dHJpYnV0ZSAoT2JzaWRpYW4gc3R5bGUpXG4gICAgdGQuYWRkUnVsZSgnbG9jYWxJbWFnZXMnLCB7XG4gICAgICAgIGZpbHRlcjogKG5vZGUpID0+IG5vZGUubm9kZU5hbWUgPT09ICdJTUcnICYmIG5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLWxvY2FsLXNyYycpLFxuICAgICAgICByZXBsYWNlbWVudDogKGNvbnRlbnQsIG5vZGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxvY2FsSWQgPSBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1sb2NhbC1zcmMnKTtcbiAgICAgICAgICAgIHJldHVybiBgIVtbYXNzZXRzLyR7bG9jYWxJZH0ucG5nXV1gO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBSdWxlIGZvciBsb2NhbCBmaWxlIGF0dGFjaG1lbnRzIChPYnNpZGlhbiBzdHlsZSlcbiAgICB0ZC5hZGRSdWxlKCdsb2NhbEZpbGVzJywge1xuICAgICAgICBmaWx0ZXI6IChub2RlKSA9PiBub2RlLm5vZGVOYW1lID09PSAnQScgJiYgbm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtbG9jYWwtZmlsZScpLFxuICAgICAgICByZXBsYWNlbWVudDogKGNvbnRlbnQsIG5vZGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxvY2FsTmFtZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLWxvY2FsLWZpbGUnKTtcbiAgICAgICAgICAgIC8vIFByZWZlciB0aGUgZXhwbGljaXRseSBwYXNzZWQgZmlsZW5hbWUgZnJvbSBzY3JhcGVyLCBmYWxsaW5nIGJhY2sgdG8gdGV4dFxuICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxOYW1lID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsZW5hbWUnKSB8fCBub2RlLmlubmVyVGV4dC50cmltKCkgfHwgJ2ZpbGUnO1xuICAgICAgICAgICAgY29uc3QgZXh0ID0gb3JpZ2luYWxOYW1lLmluY2x1ZGVzKCcuJykgPyBvcmlnaW5hbE5hbWUuc3BsaXQoJy4nKS5wb3AoKSA6ICdiaW4nO1xuICAgICAgICAgICAgcmV0dXJuIGBbW2Fzc2V0cy8ke2xvY2FsTmFtZX0uJHtleHR9XV1gO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBSdWxlIGZvciBpbnRlcm5hbCBjcm9zcy1saW5rc1xuICAgIHRkLmFkZFJ1bGUoJ2ludGVybmFsTGlua3MnLCB7XG4gICAgICAgIGZpbHRlcjogKG5vZGUpID0+IG5vZGUubm9kZU5hbWUgPT09ICdBJyAmJiBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1pbnRlcm5hbC1saW5rJyksXG4gICAgICAgIHJlcGxhY2VtZW50OiAoY29udGVudCwgbm9kZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGlua0lkID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW50ZXJuYWwtbGluaycpO1xuICAgICAgICAgICAgY29uc3QgdGV4dCA9IG5vZGUuaW5uZXJUZXh0LnRyaW0oKTtcbiAgICAgICAgICAgIC8vIFVzZSBhIHNwZWNpZmljIG1hcmtlciBmb3IgcG9zdC1wcm9jZXNzaW5nXG4gICAgICAgICAgICByZXR1cm4gYFtbJHt0ZXh0fV1dPCEtLSBvbmVub3RlLWxpbms6JHtsaW5rSWR9IC0tPmA7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFJ1bGUgZm9yIFlvdVR1YmUvVmltZW8gZW1iZWRzXG4gICAgdGQuYWRkUnVsZSgnZW1iZWRzJywge1xuICAgICAgICBmaWx0ZXI6IChub2RlKSA9PiBub2RlLm5vZGVOYW1lID09PSAnSUZSQU1FJyAmJiBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1lbWJlZC1pZCcpLFxuICAgICAgICByZXBsYWNlbWVudDogKGNvbnRlbnQsIG5vZGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNyYyA9IG5vZGUuZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgICAgIC8vIENvbnZlcnQgZW1iZWQgVVJMcyBiYWNrIHRvIHdhdGNoIFVSTHMgaWYgcG9zc2libGVcbiAgICAgICAgICAgIGxldCB1cmwgPSBzcmM7XG4gICAgICAgICAgICBpZiAoc3JjLmluY2x1ZGVzKCd5b3V0dWJlLmNvbS9lbWJlZC8nKSkge1xuICAgICAgICAgICAgICAgIHVybCA9IHNyYy5yZXBsYWNlKCd5b3V0dWJlLmNvbS9lbWJlZC8nLCAneW91dHViZS5jb20vd2F0Y2g/dj0nKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3JjLmluY2x1ZGVzKCdwbGF5ZXIudmltZW8uY29tL3ZpZGVvLycpKSB7XG4gICAgICAgICAgICAgICAgdXJsID0gc3JjLnJlcGxhY2UoJ3BsYXllci52aW1lby5jb20vdmlkZW8vJywgJ3ZpbWVvLmNvbS8nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBgXFxuXFxuW1ZpZGVvIExpbmtdKCR7dXJsfSlcXG5cXG5gO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBSdWxlIGZvciBsb2NhbCB2aWRlb3Mgd2l0aCBkYXRhLWxvY2FsLXZpZGVvIChPYnNpZGlhbiBzdHlsZSlcbiAgICB0ZC5hZGRSdWxlKCdsb2NhbFZpZGVvcycsIHtcbiAgICAgICAgZmlsdGVyOiAobm9kZSkgPT4gbm9kZS5ub2RlTmFtZSA9PT0gJ1ZJREVPJyAmJiBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1sb2NhbC12aWRlbycpLFxuICAgICAgICByZXBsYWNlbWVudDogKGNvbnRlbnQsIG5vZGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxvY2FsSWQgPSBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1sb2NhbC12aWRlbycpO1xuICAgICAgICAgICAgcmV0dXJuIGBcXG5cXG4hW1thc3NldHMvJHtsb2NhbElkfS5tcDRdXVxcblxcbmA7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFJ1bGUgZm9yIFN0cmlrZXRocm91Z2ggKE9uZU5vdGUgc3BlY2lmaWMpXG4gICAgdGQuYWRkUnVsZSgnc3RyaWtldGhyb3VnaCcsIHtcbiAgICAgICAgZmlsdGVyOiAobm9kZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY2xhc3NlcyA9IHR5cGVvZiBub2RlLmNsYXNzTmFtZSA9PT0gJ3N0cmluZycgPyBub2RlLmNsYXNzTmFtZSA6ICcnO1xuICAgICAgICAgICAgY29uc3Qgc3R5bGUgPSBub2RlLmdldEF0dHJpYnV0ZSgnc3R5bGUnKSB8fCAnJztcbiAgICAgICAgICAgIHJldHVybiBjbGFzc2VzLmluY2x1ZGVzKCdTdHJpa2V0aHJvdWdoJykgfHwgc3R5bGUuaW5jbHVkZXMoJ3RleHQtZGVjb3JhdGlvbjogbGluZS10aHJvdWdoJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlcGxhY2VtZW50OiAoY29udGVudCkgPT4gYH5+JHtjb250ZW50fX5+YFxuICAgIH0pO1xuXG4gICAgLy8gUnVsZSB0byBpZ25vcmUgT25lTm90ZSB0YWJsZSBqdW5rIChyZXNpemUgaGFuZGxlcywgaG92ZXIgVUksIGV0Yy4pXG4gICAgdGQuYWRkUnVsZSgnaWdub3JlVGFibGVKdW5rJywge1xuICAgICAgICBmaWx0ZXI6IChub2RlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjbGFzc2VzID0gbm9kZS5jbGFzc05hbWUgfHwgJyc7XG4gICAgICAgICAgICAvLyBSRU1PVkVEICdSZWxhdGl2ZUVsZW1lbnRDb250YWluZXInIGFzIGl0IG9mdGVuIHdyYXBzIGltYWdlcyB3ZSB3YW50IHRvIGtlZXBcbiAgICAgICAgICAgIC8vIFJFTU9WRUQgJ3JvbGU9XCJwcmVzZW50YXRpb25cIicgYXMgaXQgaXMgdXNlZCBmb3IgaW1hZ2UgY29udGFpbmVyc1xuICAgICAgICAgICAgcmV0dXJuIGNsYXNzZXMuaW5jbHVkZXMoJ1RhYmxlSG92ZXInKSB8fFxuICAgICAgICAgICAgICAgIGNsYXNzZXMuaW5jbHVkZXMoJ1RhYmxlSW5zZXJ0Um93R2FwJykgfHxcbiAgICAgICAgICAgICAgICBjbGFzc2VzLmluY2x1ZGVzKCdUYWJsZUNvbHVtbkhhbmRsZScpIHx8XG4gICAgICAgICAgICAgICAgY2xhc3Nlcy5pbmNsdWRlcygnVGFibGVDb2x1bW5XaWR0aFNwYWNlcicpIHx8XG4gICAgICAgICAgICAgICAgY2xhc3Nlcy5pbmNsdWRlcygnVGFibGVDb2x1bW5SZXNpemVIYW5kbGUnKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVwbGFjZW1lbnQ6ICgpID0+ICcnXG4gICAgfSk7XG5cbiAgICAvLyBSdWxlIGZvciBPdXRsaW5lQ29udGFpbmVyIHRvIGVuc3VyZSBibG9jayBzZXBhcmF0aW9uXG4gICAgdGQuYWRkUnVsZSgnb3V0bGluZXMnLCB7XG4gICAgICAgIGZpbHRlcjogKG5vZGUpID0+IHR5cGVvZiBub2RlLmNsYXNzTmFtZSA9PT0gJ3N0cmluZycgJiYgbm9kZS5jbGFzc05hbWUuaW5jbHVkZXMoJ091dGxpbmVDb250YWluZXInKSxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IChjb250ZW50KSA9PiBgXFxuXFxuJHtjb250ZW50fVxcblxcbmBcbiAgICB9KTtcblxuICAgIC8vIEVuc3VyZSB0YWJsZSBjZWxscyBhcmUgdHJlYXRlZCBhcyBzdWNoIGV2ZW4gd2l0aCB3ZWlyZCByb2xlc1xuICAgIHRkLmFkZFJ1bGUoJ3RhYmxlQ2VsbHMnLCB7XG4gICAgICAgIGZpbHRlcjogKG5vZGUpID0+IChub2RlLm5vZGVOYW1lID09PSAnVEQnIHx8IG5vZGUubm9kZU5hbWUgPT09ICdUSCcpIHx8XG4gICAgICAgICAgICAobm9kZS5nZXRBdHRyaWJ1dGUoJ3JvbGUnKSA9PT0gJ3Jvd2hlYWRlcicgfHwgbm9kZS5nZXRBdHRyaWJ1dGUoJ3JvbGUnKSA9PT0gJ2NvbHVtbmhlYWRlcicpLFxuICAgICAgICByZXBsYWNlbWVudDogZnVuY3Rpb24gKGNvbnRlbnQsIG5vZGUpIHtcbiAgICAgICAgICAgIC8vIFRyaW0gYW5kIGVuc3VyZSBubyBuZXdsaW5lcyBpbnNpZGUgY2VsbHMgZm9yIEdGTSBjb21wYXRcbiAgICAgICAgICAgIHJldHVybiAnfCAnICsgY29udGVudC50cmltKCkucmVwbGFjZSgvXFxuL2csICcgJykgKyAnICc7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFdlIG5lZWQgYSBjdXN0b20gdGFibGUgcm93IHJ1bGUgYmVjYXVzZSBPbmVOb3RlIGRvZXNuJ3QgYWx3YXlzIHVzZSBzdGFuZGFyZCB0YWJsZSBzdHJ1Y3R1cmVzXG4gICAgdGQuYWRkUnVsZSgndGFibGVSb3cnLCB7XG4gICAgICAgIGZpbHRlcjogJ3RyJyxcbiAgICAgICAgcmVwbGFjZW1lbnQ6IGZ1bmN0aW9uIChjb250ZW50LCBub2RlKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gY29udGVudCArICd8XFxuJztcbiAgICAgICAgICAgIC8vIElmIGl0J3MgdGhlIGZpcnN0IHJvdywgYWRkIHRoZSBHRk0gc2VwYXJhdG9yXG4gICAgICAgICAgICBjb25zdCBpc0ZpcnN0Um93ID0gbm9kZSA9PT0gbm9kZS5wYXJlbnRFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgICAgICAgaWYgKGlzRmlyc3RSb3cpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZWxscyA9IG5vZGUucXVlcnlTZWxlY3RvckFsbCgndGQsIHRoLCBbcm9sZSo9XCJoZWFkZXJcIl0nKTtcbiAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ3wnICsgQXJyYXkuZnJvbShjZWxscykubWFwKCgpID0+ICcgLS0tICcpLmpvaW4oJ3wnKSArICd8XFxuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEN1c3RvbSB0YWJsZSBydWxlIHRvIGp1c3Qgd3JhcCB0aGUgY29udGVudFxuICAgIHRkLmFkZFJ1bGUoJ3RhYmxlJywge1xuICAgICAgICBmaWx0ZXI6ICd0YWJsZScsXG4gICAgICAgIHJlcGxhY2VtZW50OiBmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICAgICAgcmV0dXJuICdcXG5cXG4nICsgY29udGVudCArICdcXG5cXG4nO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0geyBjcmVhdGVNYXJrZG93bkNvbnZlcnRlciB9O1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxlQUFlLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDM0MsTUFBTTtFQUFFQztBQUFJLENBQUMsR0FBR0QsT0FBTyxDQUFDLHFCQUFxQixDQUFDOztBQUU5QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVNFLHVCQUF1QkEsQ0FBQSxFQUFHO0VBQy9CLE1BQU1DLEVBQUUsR0FBRyxJQUFJSixlQUFlLENBQUM7SUFDM0JLLFlBQVksRUFBRSxLQUFLO0lBQ25CQyxjQUFjLEVBQUU7RUFDcEIsQ0FBQyxDQUFDO0VBQ0ZGLEVBQUUsQ0FBQ0csR0FBRyxDQUFDTCxHQUFHLENBQUM7O0VBRVg7RUFDQUUsRUFBRSxDQUFDSSxPQUFPLENBQUMsYUFBYSxFQUFFO0lBQ3RCQyxNQUFNLEVBQUdDLElBQUksSUFBS0EsSUFBSSxDQUFDQyxRQUFRLEtBQUssS0FBSyxJQUFJRCxJQUFJLENBQUNFLFlBQVksQ0FBQyxnQkFBZ0IsQ0FBQztJQUNoRkMsV0FBVyxFQUFFQSxDQUFDQyxPQUFPLEVBQUVKLElBQUksS0FBSztNQUM1QixNQUFNSyxPQUFPLEdBQUdMLElBQUksQ0FBQ0UsWUFBWSxDQUFDLGdCQUFnQixDQUFDO01BQ25ELE9BQU8sYUFBYUcsT0FBTyxRQUFRO0lBQ3ZDO0VBQ0osQ0FBQyxDQUFDOztFQUVGO0VBQ0FYLEVBQUUsQ0FBQ0ksT0FBTyxDQUFDLFlBQVksRUFBRTtJQUNyQkMsTUFBTSxFQUFHQyxJQUFJLElBQUtBLElBQUksQ0FBQ0MsUUFBUSxLQUFLLEdBQUcsSUFBSUQsSUFBSSxDQUFDRSxZQUFZLENBQUMsaUJBQWlCLENBQUM7SUFDL0VDLFdBQVcsRUFBRUEsQ0FBQ0MsT0FB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