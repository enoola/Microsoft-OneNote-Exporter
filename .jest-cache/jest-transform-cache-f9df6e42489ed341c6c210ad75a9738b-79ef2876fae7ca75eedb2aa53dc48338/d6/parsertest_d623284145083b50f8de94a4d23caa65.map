{"version":3,"names":["createMarkdownConverter","require","JSDOM","describe","td","beforeEach","test","html","markdown","turndown","expect","toBe","trim","toMatch","toContain"],"sources":["parser.test.js"],"sourcesContent":["const { createMarkdownConverter } = require('../src/parser');\nconst { JSDOM } = require('jsdom');\n\ndescribe('Parser - createMarkdownConverter', () => {\n    let td;\n\n    beforeEach(() => {\n        td = createMarkdownConverter();\n    });\n\n    describe('Local Images', () => {\n        test('converts images with data-local-src to Obsidian format', () => {\n            const html = '<img src=\"http://example.com/img.png\" data-local-src=\"my_image\" />';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('![[assets/my_image.png]]');\n        });\n\n        test('ignores images without data-local-src', () => {\n            const html = '<img src=\"http://example.com/img.png\" />';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('![](http://example.com/img.png)');\n        });\n    });\n\n    describe('Local Files (Attachments)', () => {\n        test('converts links with data-local-file to Obsidian format', () => {\n            const html = '<a href=\"http://example.com/doc.pdf\" data-local-file=\"my_doc\" data-filename=\"document.pdf\">Download</a>';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('[[assets/my_doc.pdf]]');\n        });\n\n        test('handles file without extension', () => {\n            const html = '<a href=\"http://example.com/file\" data-local-file=\"my_file\" data-filename=\"unknown\">Download</a>';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('[[assets/my_file.bin]]');\n        });\n    });\n\n    describe('Internal Links', () => {\n        test('converts internal links with placeholder comments', () => {\n            const html = '<a href=\"onenote:page-id=123\" data-internal-link=\"link_0\">My Page</a>';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('[[My Page]]<!-- onenote-link:link_0 -->');\n        });\n    });\n\n    describe('Video Embeds', () => {\n        test('converts YouTube embeds to watch URLs', () => {\n            const html = '<iframe src=\"https://www.youtube.com/embed/dQw4w9WgXcQ\" data-embed-id=\"embed_0\"></iframe>';\n            const markdown = td.turndown(html);\n            expect(markdown.trim()).toBe('[Video Link](https://www.youtube.com/watch?v=dQw4w9WgXcQ)');\n        });\n\n        test('converts Vimeo embeds', () => {\n            const html = '<iframe src=\"https://player.vimeo.com/video/123456\" data-embed-id=\"embed_1\"></iframe>';\n            const markdown = td.turndown(html);\n            expect(markdown.trim()).toBe('[Video Link](https://vimeo.com/123456)');\n        });\n    });\n\n    describe('Local Videos', () => {\n        test('converts local videos to Obsidian embed format', () => {\n            const html = '<video data-local-video=\"my_video\"></video>';\n            const markdown = td.turndown(html);\n            expect(markdown.trim()).toBe('![[assets/my_video.mp4]]');\n        });\n    });\n\n    describe('Strikethrough', () => {\n        test('converts elements with Strikethrough class', () => {\n            const html = '<span class=\"Strikethrough\">crossed out</span>';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('~~crossed out~~');\n        });\n\n        test('converts elements with line-through style', () => {\n            const html = '<span style=\"text-decoration: line-through\">crossed out</span>';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('~~crossed out~~');\n        });\n    });\n\n    describe('OneNote Table Junk', () => {\n        test('ignores TableHover elements', () => {\n            const html = '<div class=\"TableHover\">Hover UI</div><p>Content</p>';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('Content');\n        });\n\n        test('ignores resize handles', () => {\n            const html = '<div class=\"TableColumnResizeHandle\"></div><p>Cell Content</p>';\n            const markdown = td.turndown(html);\n            expect(markdown).toBe('Cell Content');\n        });\n    });\n\n    describe('OutlineContainer', () => {\n        test('adds block separation for OutlineContainer', () => {\n            const html = '<div class=\"OutlineContainer\">Block content</div>';\n            const markdown = td.turndown(html);\n            expect(markdown.trim()).toBe('Block content');\n            expect(markdown).toMatch(/^\\n\\n.*\\n\\n$/);\n        });\n    });\n\n    describe('Tables', () => {\n        test('converts simple table to GFM', () => {\n            const html = `\n                <table>\n                    <tr><td>A</td><td>B</td></tr>\n                    <tr><td>1</td><td>2</td></tr>\n                </table>\n            `;\n            const markdown = td.turndown(html);\n            expect(markdown).toContain('| A | B |');\n            expect(markdown).toContain('| --- | --- |');\n            expect(markdown).toContain('| 1 | 2 |');\n        });\n\n        test('handles tables with role attributes', () => {\n            const html = `\n                <table>\n                    <tr><div role=\"rowheader\">Header</div><div role=\"columnheader\">Col</div></tr>\n                    <tr><td>Data</td><td>Value</td></tr>\n                </table>\n            `;\n            const markdown = td.turndown(html);\n            expect(markdown).toContain('| Header | Col |');\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}